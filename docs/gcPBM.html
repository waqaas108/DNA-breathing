<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DNA Breathing in ChIP-seq and gcPBM Data - Analysis of gcPBM data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DNA Breathing in ChIP-seq and gcPBM Data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview-on-the-dataset-and-data-processing" id="toc-overview-on-the-dataset-and-data-processing" class="nav-link active" data-scroll-target="#overview-on-the-dataset-and-data-processing">Overview on the Dataset and Data Processing</a>
  <ul class="collapse">
  <li><a href="#bubbles" id="toc-bubbles" class="nav-link" data-scroll-target="#bubbles">Bubbles</a></li>
  <li><a href="#motifs" id="toc-motifs" class="nav-link" data-scroll-target="#motifs">Motifs</a></li>
  <li><a href="#processed-data" id="toc-processed-data" class="nav-link" data-scroll-target="#processed-data">Processed Data</a></li>
  </ul></li>
  <li><a href="#statistical-investigation" id="toc-statistical-investigation" class="nav-link" data-scroll-target="#statistical-investigation">Statistical Investigation</a>
  <ul class="collapse">
  <li><a href="#fischers-exact-test" id="toc-fischers-exact-test" class="nav-link" data-scroll-target="#fischers-exact-test">Fischer’s Exact Test</a></li>
  <li><a href="#the-effect-of-the-distance-between-bubbles-and-motifs" id="toc-the-effect-of-the-distance-between-bubbles-and-motifs" class="nav-link" data-scroll-target="#the-effect-of-the-distance-between-bubbles-and-motifs">The effect of the distance between bubbles and motifs</a></li>
  </ul></li>
  <li><a href="#linear-regressions" id="toc-linear-regressions" class="nav-link" data-scroll-target="#linear-regressions">Linear Regressions</a></li>
  <li><a href="#correlations-of-motif-positions-and-flipping-features" id="toc-correlations-of-motif-positions-and-flipping-features" class="nav-link" data-scroll-target="#correlations-of-motif-positions-and-flipping-features">Correlations of Motif positions and Flipping features</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of gcPBM data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<style>
  code {
    white-space : pre-wrap !important;
    word-break: break-word;
  }
</style>
<section id="overview-on-the-dataset-and-data-processing" class="level2">
<h2 class="anchored" data-anchor-id="overview-on-the-dataset-and-data-processing">Overview on the Dataset and Data Processing</h2>
<section id="bubbles" class="level3">
<h3 class="anchored" data-anchor-id="bubbles">Bubbles</h3>
<p>We acquired gcPBM datasets for three TFs (MAX: 8568 sequences, MAD: 7534 sequences, MYC: 6926 sequences) from Alexandrov Boian’s lab. We simulated corresponding feature data for flipping and bubbles using pyDNA, a package developed by the same lab which uses MCMC simulation to derive feature values from sequences.</p>
<p>The bubble data, once generated, was in the form of 3 dimensional tensors, with the x-axis corresponding to the base-pair positions of the sequences, the y-axis corresponding to the length of bubbles horizontally across the sequence, and the z-axis corresponding to the amplitude of the bubbles measured in Armstrongs. The values in each tensor reflected the probability of finding the bubble across a certain time duration.</p>
<div id="fig-Bubble_Graphs" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_raw/image.png" class="lightbox" data-gallery="raw_bubble"><img src="figs/phase3_new/bubble_raw/image.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_raw/image2.png" class="lightbox" data-gallery="raw_bubble"><img src="figs/phase3_new/bubble_raw/image2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_raw/image3.png" class="lightbox" data-gallery="raw_bubble"><img src="figs/phase3_new/bubble_raw/image3.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;1: 3d surface plots of some sequences across different amplitude thresholds</figcaption><p></p>
</figure>
</div>
<p>We decided to use an Armstrong threshold of 3.5 and a bubble length threshold of 10 for the rest of our analyses as these are the thresholds used in literature published by the lab that developed the package.</p>
</section>
<section id="motifs" class="level3">
<h3 class="anchored" data-anchor-id="motifs">Motifs</h3>
<p>We tried to acquire motifs for the TFs from the JASPAR database, but we were unable to find motifs for MAD. We then used the motifs for MAX and MYC to scan for motif presence in the sequences of the gcPBM data. We used the FIMO tool from the MEME suite to scan for motif presence. We used the following parameters:</p>
<p>p-value ≤ 1 x 10^-4 (strong motif match)</p>
<p>p-value &gt; 1 x 10^-4 and ≤ 1 x 10^-3 (weak motif match)</p>
<p>The consensus sequences for the motifs were:</p>
<p>MAX: 5’-ACCACGTGCC-3’</p>
<p>MYC: 5’-GGCCACGTGCCC-3’</p>
</section>
<section id="processed-data" class="level3">
<h3 class="anchored" data-anchor-id="processed-data">Processed Data</h3>
<p>Once we had the motifs and bubbles identified and tied to base pair locations, we did some basic exploration of the sequences and how motifs and bubbles presented themselves. The lists below show the relative positions of motifs and bubbles in the sequences, with the strand of the motif also indicated.</p>
<p>Top 5 sequences per TF in terms of binding affinity that also have bubble features:</p>
<p>TF = max</p>
<pre class="{code}"><code>1.  DNA_sequence    = TGTGGCTTATCAAACCACGTGGTTTATCAAAATAAT
1.  Bubble_sequence = ---------+--------------------------
1.  Motif_positive  = -------------++++++++++-------------
1.  Motif_negative  = ------------------------------------
1.  Motif_sequence  = -------------++++++++++-------------
2.  DNA_sequence    = TTACGCTCTTTCTACCACGTGGTGCTAATTGAAGGG
2.  Bubble_sequence = -----------+------------------------
2.  Motif_positive  = -------------++++++++++-------------
2.  Motif_negative  = ------------------------------------
2.  Motif_sequence  = -------------++++++++++-------------
3.  DNA_sequence    = AAGAAAAAGAAGTACCACGTGGTAAACAGAATACCT
3.  Bubble_sequence = ----------------------+-------------
3.  Motif_positive  = -------------++++++++++-------------
3.  Motif_negative  = ------------------------------------
3.  Motif_sequence  = -------------++++++++++-------------
4.  DNA_sequence    = GCCACACTATCTTACCACGTGGTACAGCTTCTACGG
4.  Bubble_sequence = ---+--------------------------------
4.  Motif_positive  = -------------++++++++++-------------
4.  Motif_negative  = ------------------------------------
4.  Motif_sequence  = -------------++++++++++-------------
5.  DNA_sequence    = GTGTCATTGCTGTACCACGTGGTGTTGGTGTCGTTG
5.  Bubble_sequence = -----------------+------------------
5.  Motif_positive  = -------------++++++++++-------------
5.  Motif_negative  = ------------------------------------
5.  Motif_sequence  = -------------++++++++++-------------</code></pre>
<p>TF = myc</p>
<pre class="{code}"><code>1.  DNA_sequence    = TGTGGCTTATCAAACCACGTGGTTTATCAAAATAAT
1.  Bubble_sequence = -----------+------------------------
1.  Motif_positive  = ------------++++++++++++------------
1.  Motif_negative  = ------------------------------------
1.  Motif_sequence  = ------------++++++++++++------------
2.  DNA_sequence    = CTAGAACCTTTGTACCACGTGGCATTTTTTTAAACT
2.  Bubble_sequence = ---------------+--------------------
2.  Motif_positive  = ------------------------------------
2.  Motif_negative  = ------------++++++++++++------------
2.  Motif_sequence  = ------------++++++++++++------------
3.  DNA_sequence    = GGGCTTATGAGAGACCACGTGGTCTTGTGCTTTAGT
3.  Bubble_sequence = ----------------+-------------------
3.  Motif_positive  = ------------++++++++++++------------
3.  Motif_negative  = ------------------------------------
3.  Motif_sequence  = ------------++++++++++++------------
4.  DNA_sequence    = ATTGATTTTTACTGCCACGTGGTTTCCCATTCTATT
4.  Bubble_sequence = -+----------------------------------
4.  Motif_positive  = ------------++++++++++++------------
4.  Motif_negative  = ------------------------------------
4.  Motif_sequence  = ------------++++++++++++------------
5.  DNA_sequence    = TAGTTGTGCCACAACCACGTGGTCCTGGAAACTGCC
5.  Bubble_sequence = ---------+--------------------------
5.  Motif_positive  = ------------++++++++++++------------
5.  Motif_negative  = ------------------------------------
5.  Motif_sequence  = ------------++++++++++++------------</code></pre>
</section>
</section>
<section id="statistical-investigation" class="level2">
<h2 class="anchored" data-anchor-id="statistical-investigation">Statistical Investigation</h2>
<p>We conducted statistical investigations into the relationship between bubbles, motifs, and binding affinity. Our first investigation was a t-test to see if the presence of a bubble significantly affected binding affinity.</p>
<pre class="{code}"><code>MAD
T-statistic: 3.0415
P-value: 0.0023625157500119496

MAX
T-statistic: 4.5823
P-value: 4.663198015900617e-06

MYC
T-statistic: 1.5249
P-value: 0.1273411464685596</code></pre>
<p>The test results for myc showed that there was no significant correlation between bubble presence and binding affinity. Since the distribution of binding affinity was not normal, we also conducted a Mann-Whitney U test.</p>
<pre class="{code}"><code>MAD
U Statistic: 4410794.5
P-Value: 3.430484717720097e-10

MAX
U Statistic: 5564323.5
P-Value: 3.129469915381394e-15

MYC
U Statistic: 3577091.0
P-Value: 0.005709047733220515</code></pre>
<p>All TFs showed a significant relationship between bubble presence and binding affinity when using the Mann-Whitney U test.</p>
<div id="fig-box_and_histograms" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/mad_box.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/mad_box.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/mad_hist.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/mad_hist.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/max_box.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/max_box.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/max_hist.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/max_hist.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/myc_box.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/myc_box.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 50.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/bubble_threshold_ttest/myc_hist.png" class="lightbox" data-gallery="boxplot_histogram"><img src="figs/phase3_new/bubble_threshold_ttest/myc_hist.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;2: Boxplots and histograms of binding affinity for sequences with and without bubbles.</figcaption><p></p>
</figure>
</div>
<p>Since we were unable to find a motif for MAD from JASPAR, the statistical analyses investigating motifs were conducted with the data for MAX and MYC only.</p>
<section id="fischers-exact-test" class="level3">
<h3 class="anchored" data-anchor-id="fischers-exact-test">Fischer’s Exact Test</h3>
<p>We conducted a Fischer’s Exact Test to see if the presence of a bubble and motif together significantly affected binding affinity. We counted the base pair positions across our entire dataset that had a bubble, motif, or both, and used these counts to construct a contingency table for the Fischer’s Exact Test.</p>
<div id="fig-Fischer" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<pre class="{code}"><code>{'max': {'L': 308448, 'B': 1361, 'M': 18770, 'x': 46},
 'myc': {'L': 249336, 'B': 1186, 'M': 31632, 'x': 85}}</code></pre>
<pre class="{code}"><code>TF: max
Contingency Table:
         | Bubble+ | Bubble-
Motif+   |   46   |   18724
Motif-   |   1315   |   288363
Odds Ratio: 0.5387322587955679
P-value: 8.510400968969282e-06

TF: myc
Contingency Table:
         | Bubble+ | Bubble-
Motif+   |   85   |   31547
Motif-   |   1101   |   216603
Odds Ratio: 0.5300758377124949
P-value: 1.0090991397916577e-09</code></pre>
<figcaption class="figure-caption">Figure&nbsp;3: Fisher’s Exact test using all sequences: L = total length of sequences, B = coordinates with a bubble, M = coordinates with a motif, x = coordinates with both a motif and bubble.</figcaption>
</figure>
</div>
<p>The results of the Fischer’s Exact Test showed that the presence of a bubble and motif together significantly affected binding affinity.</p>
</section>
<section id="the-effect-of-the-distance-between-bubbles-and-motifs" class="level3">
<h3 class="anchored" data-anchor-id="the-effect-of-the-distance-between-bubbles-and-motifs">The effect of the distance between bubbles and motifs</h3>
<p>We then investigated the effect of the distance between bubbles and motifs on binding affinity. To this end, we categorized the top 10% of sequences by binding affinity to be positive sequences. We then defined close distances between motifs and bubbles using a maximum threshold, and then performed a fischer’s exact test at different thresholds.</p>
<div id="fig-Fischer" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 48.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/binding_posvneg_distance/max_posvneg_10.png" class="lightbox" data-gallery="bubble_motif_distance2"><img src="figs/phase3_new/binding_posvneg_distance/max_posvneg_10.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 4.0%;justify-content: center;">
<p>&nbsp;</p>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 48.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/binding_posvneg_distance/myc_posvneg_10.png" class="lightbox" data-gallery="bubble_motif_distance2"><img src="figs/phase3_new/binding_posvneg_distance/myc_posvneg_10.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;4: Histograms showing the distribution of distances between bubbles and motifs for positive and negative sequences (top 10% of sequences by binding affinity = positive).</figcaption><p></p>
</figure>
</div>
<div id="tbl-letters" class="anchored">
<table class="table">
<caption>Table&nbsp;1: Summary of the results of the Fischer’s Exact Test at different distance thresholds.</caption>
<thead>
<tr class="header">
<th>Threshold</th>
<th>Max Odds Ratio (P-value)</th>
<th>Myc Odds Ratio (P-value)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>≤ 1</td>
<td>1.553086 (0.182921)</td>
<td>1.119199 (0.702150)</td>
</tr>
<tr class="even">
<td>≤ 2</td>
<td>1.784314 (0.052449)</td>
<td>1.186207 (0.543130)</td>
</tr>
<tr class="odd">
<td>≤ 3</td>
<td>1.604651 (0.106206)</td>
<td>1.223536 (0.407174)</td>
</tr>
<tr class="even">
<td>≤ 4</td>
<td>1.655518 (0.081682)</td>
<td>0.996443 (1.000000)</td>
</tr>
<tr class="odd">
<td>≤ 5</td>
<td>1.539542 (0.140837)</td>
<td>1.173838 (0.545392)</td>
</tr>
</tbody>
</table>
</div>
<p>The results were not significant for either TF. This suggests that the distance between bubbles and motifs does not significantly affect binding affinity, but might also be a result of a stringent threshold for bubble positivity.</p>
</section>
</section>
<section id="linear-regressions" class="level2">
<h2 class="anchored" data-anchor-id="linear-regressions">Linear Regressions</h2>
<p>We then conducted linear regressions to see the degree to which the presence of a bubble, motif, and an interaction feature significantly affected binding affinity.</p>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(a) Linear regression results for MAX (R-squared = 0.645, F-statistic = 5197).</caption>
<colgroup>
<col style="width: 28%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt; abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">3.9901</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;">2329.676</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">3.987</td>
<td style="text-align: left;">3.993</td>
</tr>
<tr class="even">
<td style="text-align: left;">motif_binary</td>
<td style="text-align: left;">0.4215</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">117.860</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.414</td>
<td style="text-align: left;">0.429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.0635</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">15.279</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.055</td>
<td style="text-align: left;">0.072</td>
</tr>
<tr class="even">
<td style="text-align: left;">motif_and_bubble_binary</td>
<td style="text-align: left;">-0.0437</td>
<td style="text-align: left;">0.010</td>
<td style="text-align: left;">-4.369</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">-0.063</td>
<td style="text-align: left;">-0.024</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(b) Linear regression results for MYC (R-squared = 0.344, F-statistic = 1209).</caption>
<colgroup>
<col style="width: 27%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt; abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">8.2609</td>
<td style="text-align: left;">0.011</td>
<td style="text-align: left;">754.318</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">8.239</td>
<td style="text-align: left;">8.282</td>
</tr>
<tr class="even">
<td style="text-align: left;">motif_binary</td>
<td style="text-align: left;">0.9479</td>
<td style="text-align: left;">0.017</td>
<td style="text-align: left;">54.802</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.914</td>
<td style="text-align: left;">0.982</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.1273</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">5.176</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.079</td>
<td style="text-align: left;">0.175</td>
</tr>
<tr class="even">
<td style="text-align: left;">motif_and_bubble_binary</td>
<td style="text-align: left;">0.0833</td>
<td style="text-align: left;">0.045</td>
<td style="text-align: left;">1.855</td>
<td style="text-align: left;">0.064</td>
<td style="text-align: left;">-0.005</td>
<td style="text-align: left;">0.171</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="panel-caption table-caption">
<p>Table&nbsp;2: Linear Regression of all sequences with Motif, Bubble, and Interaction Features.</p>
</div>
</div>
<p>We also conducted linear regressions of bubble presence against binding affinity by limiting the sequences in the regression based on motif strength. We conducted regressions for all sequences, sequences without strong motifs (weak motif matches and no motif matches), and sequences with only weak motif matches.</p>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(a) Linear regression results for MAX (R-squared = 0.000, F-statistic = 2.325).</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">4.0867</td>
<td style="text-align: left;">0.003</td>
<td style="text-align: left;">1620.669</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">4.082</td>
<td style="text-align: left;">4.092</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.0290</td>
<td style="text-align: left;">0.006</td>
<td style="text-align: left;">4.582</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.017</td>
<td style="text-align: left;">0.041</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(b) Linear regression results for MYC (R-squared = 0.002, F-statistic = 21.00).</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">8.6408</td>
<td style="text-align: left;">0.010</td>
<td style="text-align: left;">826.004</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">8.620</td>
<td style="text-align: left;">8.661</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.0385</td>
<td style="text-align: left;">0.025</td>
<td style="text-align: left;">1.525</td>
<td style="text-align: left;">0.127</td>
<td style="text-align: left;">-0.011</td>
<td style="text-align: left;">0.088</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="panel-caption table-caption">
<p>Table&nbsp;3: Linear Regression of all sequences with Bubble Features.</p>
</div>
</div>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(a) Linear regression results for MAX (R-squared = 0.032, F-statistic = 219.1).</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">3.9901</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;">2256.927</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">3.987</td>
<td style="text-align: left;">3.994</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.0635</td>
<td style="text-align: left;">0.004</td>
<td style="text-align: left;">14.802</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.055</td>
<td style="text-align: left;">0.072</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(b) Linear regression results for MYC (R-squared = 0.011, F-statistic = 46.10).</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 14%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">8.2609</td>
<td style="text-align: left;">0.008</td>
<td style="text-align: left;">989.555</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">8.244</td>
<td style="text-align: left;">8.277</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.1273</td>
<td style="text-align: left;">0.019</td>
<td style="text-align: left;">6.790</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.091</td>
<td style="text-align: left;">0.164</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="panel-caption table-caption">
<p>Table&nbsp;4: Linear Regression of sequences without any strong motif matches with Bubble Features.</p>
</div>
</div>
<div id="tbl-panel" class="tbl-parent quarto-layout-panel anchored">
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(a) Linear regression results for MAX (R-squared = 0.035, F-statistic = 195.5).</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">4.0051</td>
<td style="text-align: left;">0.002</td>
<td style="text-align: left;">1938.858</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">4.001</td>
<td style="text-align: left;">4.009</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.0699</td>
<td style="text-align: left;">0.005</td>
<td style="text-align: left;">13.981</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.060</td>
<td style="text-align: left;">0.080</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-panel2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-panel" style="flex-basis: 100.0%;justify-content: center;">
<table class="table">
<caption>(b) Linear regression results for MYC (R-squared = 0.009, F-statistic = 29.13).</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">coef</th>
<th style="text-align: left;">std err</th>
<th style="text-align: left;">t</th>
<th style="text-align: left;">P&gt;abs(t)</th>
<th style="text-align: left;">0.025</th>
<th style="text-align: left;">0.975</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">const</td>
<td style="text-align: left;">8.3878</td>
<td style="text-align: left;">0.009</td>
<td style="text-align: left;">916.256</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">8.370</td>
<td style="text-align: left;">8.406</td>
</tr>
<tr class="even">
<td style="text-align: left;">bubble_binary</td>
<td style="text-align: left;">0.1095</td>
<td style="text-align: left;">0.020</td>
<td style="text-align: left;">5.397</td>
<td style="text-align: left;">0.000</td>
<td style="text-align: left;">0.070</td>
<td style="text-align: left;">0.149</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="panel-caption table-caption">
<p>Table&nbsp;5: Linear Regression of sequences with weak motif matches with Bubble Features.</p>
</div>
</div>
<p>The results of the linear regressions showed that the presence of a bubble and motif significantly affected binding affinity, and that the interaction feature did not significantly affect binding affinity. The regressions performed with bubble data showed the extent to which bubbles alone explain binding.</p>
</section>
<section id="correlations-of-motif-positions-and-flipping-features" class="level2">
<h2 class="anchored" data-anchor-id="correlations-of-motif-positions-and-flipping-features">Correlations of Motif positions and Flipping features</h2>
<p>Another hypothesis of ours was that flipping features inside or near motifs may determine binding affinity. To test this, we extracted all DNA sequences with motifs. Then we computed the average flipping feature across all positions in the motifs, and found the correlation between this average flipping feature and the binding affinity of the sequence for every sequence.</p>
<pre class="{code}"><code>TF = max
Pearson Correlation with Motif Flip Feature: Correlation = 0.26, p-value = 1.13e-29
Pearson Correlation with Motif Coord Feature: Correlation = 0.20, p-value = 1.89e-18
Pearson Correlation with Motif Coord^2 Feature: Correlation = 0.06, p-value = 5.42e-3</code></pre>
<pre class="{code}"><code>TF = myc
Pearson Correlation with Motif Flip Feature: Correlation = 0.33, p-value = 1.77e-68
Pearson Correlation with Motif Coord Feature: Correlation = 0.32, p-value = 5.42e-64
Pearson Correlation with Motif Coord^2 Feature: Correlation = 0.18, p-value = 3.42e-20</code></pre>
<div id="fig-Correlation" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/max.png" class="lightbox" title="TF = max" data-gallery="correlation"><img src="figs/phase3_new/flip_correlation/max.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">TF = max</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 100.0%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/myc.png" class="lightbox" title="TF = myc" data-gallery="correlation"><img src="figs/phase3_new/flip_correlation/myc.png" class="img-fluid figure-img"></a></p>
<figcaption class="figure-caption">TF = myc</figcaption>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;5: Scatterplots showing the average flipping feature of motifs against binding affinity.</figcaption><p></p>
</figure>
</div>
<p>We then calculated correlations for each individual base pair position in the motif.</p>
<div id="fig-Correlation_bar" class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/flip_max.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/flip_max.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/coord_max.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/coord_max.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/coordsq_max.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/coordsq_max.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/flip_myc.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/flip_myc.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/coord_myc.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/coord_myc.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center" style="flex-basis: 33.3%;justify-content: center;">
<figure class="figure">
<p><a href="figs/phase3_new/flip_correlation/coordsq_myc.png" class="lightbox" data-gallery="correlation_bar"><img src="figs/phase3_new/flip_correlation/coordsq_myc.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;6: Barplots showing the correlation (and associated p-value) between flipping features and binding affinity for each base pair position in the motif.</figcaption><p></p>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","descPosition":"bottom","loop":true});</script>



</body></html>